<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="Celebration lottie constructor">
    <title>Celebration lottie constructor</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.0/css/bulma.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.0.0/animate.min.css">

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.6.10/lottie.min.js"></script>

</head>
<body>

<!--<style>-->
<!--    .lottie {-->
<!--        position: absolute;-->
<!--    }-->
<!--    .lottie-player {-->
<!--        overflow:hidden;-->
<!--        display: none;-->
<!--    }-->
<!--    .modal-background {-->
<!--        opacity: 0.67;-->
<!--    }-->
<!--</style>-->


<div class="modal is-active is-hidden">
    <div class="modal-background has-background-white"></div>
    <div
            class="modal-background has-background-white"
            style="opacity: 0.67;z-index: 2"
    ></div>
    <div>
        <div
                class="image"
                data-animation="background"
                style="
                position:absolute;
                z-index: 1;
                overflow: hidden;
                top: 0; bottom: 0;left: 0;right: 0;
                "
        ></div>
    </div>
    <div class="modal-card is-hidden" style="margin-top: -25vh; z-index: 3">
        <div class="columns is-centered is-vcentered">
            <div class="column" style="margin: 50px; max-width: 400px; max-height: 400px">
                <div data-animation="hero">
                </div>
            </div>
        </div>
        <div class="notification is-warning">
            <p id="message-text" class="title has-text-centered">
                Yay! You did it!
            </p>
        </div>
    </div>
</div>
<section id="home-panel">
    <div class="hero is-fullheight">
        <div class="hero-body">
            <div class="container">
                <div class="columns is-centered is-vcentered">
                    <div class="column is-narrow">
                        <div class="notification is-white">
                            <h1 class="title">Hello</h1>
                            <h2 class="subtitle">Someone left you a message</h2>
                            <div class="has-text-right">
                                <a onclick="startShow()" class="button is-primary is-outlined">Watch it</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<div style="position: absolute; bottom: 4px; right: 4px">
    <a onclick="goConfig(this)" class="button is-small is-fullwidth">Make your own custom congratulation</a>
</div>

<section id="config-panel" class="is-hidden">
    <div class="hero is-fullheight is-dark">
        <div class="hero-head">
            <form data-target="sound">
                <div class="columns is-centered is-vcentered notification">
                    <div class="column is-1">
                        <label class="label">Sound</label>
                    </div>

                    <div class="column">
                        <div class="field">
                            <div class="control">
                                <input name="mp3" class="input" type="text" onchange="soundLoad(this.value)" value="https://croqo.xyz/storage/app/media/vicetone-tony-igy-astronomia-atari-pokey-cover.mp3">
                            </div>
                            <p class="help is-dark">mp3 direct link</p>
                        </div>
                    </div>
                    <div class="column is-narrow">
                        <div class="field">
                            <div class="control">
                                <audio id="sound" controls>
                                    <source id="mp3">
                                </audio>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <div  class="columns is-centered is-vcentered notification">
                <div class="column is-1">
                    <label class="label">Foreground</label>
                </div>
                <div class="column">
                    <form data-target="message">
                        <div class="field">
                            <div class="control">
                                <textarea name="text" class="textarea" rows="5">Congratulations!</textarea>
                            </div>
                            <p class="help is-dark">Congratulation text</p>
                        </div>
                    </form>
                </div>
                <div class="column is-2">
                    <form data-target="foreground">
                        <div class="field">
                            <div class="control">
                                <input name="duration" class="input" type="number" step="1000" value="8000">
                            </div>
                            <p class="help is-dark">Overall duration (ms)</p>
                        </div>
                        <div class="field">
                            <div class="control">
                                <input name="delay" class="input" type="number" step="1000" value="0">
                            </div>
                            <p class="help is-dark">Foreground delay (ms)</p>
                        </div>
                    </form>
                </div>
            </div>

        </div>
        <div class="hero-body">
            <div class="container">
                <div class="columns is-centered is-vcentered">
                    <div></div>
                    <div class="column is-3">
                        <div class="box" data-animation="background">
                            <figure
                                    id="background"
                                    style="height: 100%; min-width: 100%"
                                    class="lottie-player image"
                            >
                            </figure>
                        </div>
                        <p class="help">Background animation</p>
                    </div>
                    <div class="column is-3">
                        <div class="box" data-animation="hero">
                            <figure
                                    id="hero"
                                    class="lottie-player image"
                            >
                            </figure>
                        </div>
                        <p class="help">Foreground animation</p>
                    </div>
                    <div class="column is-1">
                        <div class="field">
                            <div class="control">
                                <button onclick="startShow()" class="button is-large is-warning">Play!</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="config-animation" class="hero-foot">
            <div class="columns">
                <div class="column">
                    <form data-target="background">
                        <div class="columns is-centered box">
                            <div class="column">
                                <div class="field">
                                    <div class="control">
                                        <input name="url" class="input" type="text" value="https://assets8.lottiefiles.com/packages/lf20_fSIvGi.json">
                                    </div>
                                    <p class="level is-mobile help is-dark">
                                        <span class="level-left">Background animation json</span>
                                        <span class="level-right field">
                                    Loop?<span class="icon is-small"><input name="loop" type="checkbox" checked></span>
                                </span>
                                    </p>
                                </div>
                            </div>
                            <div class="column is-narrow">
                                <div class="field">
                                    <div class="control is-expanded">
                                        <div class="select">
                                            <select name="speed">
                                                <option value="0.5">x0.5</option>
                                                <option selected value="1">Normal</option>
                                                <option value="1.5">x1.5</option>
                                                <option value="2">x2.0</option>
                                                <option value="3">x2.5</option>
                                            </select>
                                        </div>
                                    </div>
                                    <p class="help is-dark">Animation speed</p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="column">
                    <form data-target="hero">
                        <div class="columns is-centered notification">
                            <div class="column">
                                <div class="field">
                                    <div class="control">
                                        <input name="url" class="input" type="text" value="https://assets6.lottiefiles.com/private_files/lf30_Y7PQoU.json">
                                    </div>
                                    <p class="level is-mobile help is-dark">
                                        <span class="level-left">Foreground animation json</span>
                                        <span class="level-right field">
                                    Loop?<span class="icon is-small"><input name="loop" type="checkbox" checked></span>
                                </span>
                                    </p>
                                </div>
                            </div>
                            <div class="column is-narrow">
                                <div class="field">
                                    <div class="control">
                                        <div class="select">
                                            <select name="speed">
                                                <option value="0.5">x0.5</option>
                                                <option selected value="1">Normal</option>
                                                <option value="1.5">x1.5</option>
                                                <option value="2">x2.0</option>
                                                <option value="3">x2.5</option>
                                            </select>
                                        </div>
                                    </div>
                                    <p class="help is-dark">Animation speed</p>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<script type="text/javascript" src="../index.js"></script>

<script>
    $("#config-panel figure").on("click",function () {
        let id = $(this).attr("id");
        Animation[id].goToAndPlay(0);
    });

    function startShow() {
        Sound.play();
        updateAsset("message");
        attachLotties(".modal");
        $('.modal').removeClass("is-hidden");
        Animation["background"].goToAndPlay(0);

        let d = Config["foreground"]["delay"]|0;
        setTimeout(function () {
            $(".modal-card").removeClass("is-hidden");
            Animation["hero"].goToAndPlay(0);
        }, d );
        let t = Config["foreground"]["duration"];
        setTimeout(function () {
            $('.modal').addClass("is-hidden");
            $(".modal-card").addClass("is-hidden");
            Sound.pause();
            Sound.currentTime = 0;
            attachLotties("#config-panel");
        }, t );
    }
    function goConfig(element) {
        $(element).addClass('is-hidden');
        $("#home-panel").addClass('is-hidden');
        $("#config-panel").removeClass('is-hidden');
    }
</script>
</body>
</html>